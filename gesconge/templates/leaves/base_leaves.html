{% extends "base.html" %}

{% block extra_css %}
<!-- FullCalendar CSS -->
<link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css' rel='stylesheet' />

<!-- Select2 CSS -->
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet">

<!-- Datatables CSS -->
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css">

<style>
    /* Styles spécifiques aux congés */
    .leave-status-badge {
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 500;
    }
    
    .status-draft { background-color: #6c757d; color: white; }
    .status-pending { background-color: #ffc107; color: #212529; }
    .status-approved { background-color: #28a745; color: white; }
    .status-rejected { background-color: #dc3545; color: white; }
    .status-cancelled { background-color: #6c757d; color: white; }
    .status-in_progress { background-color: #17a2b8; color: white; }
    .status-completed { background-color: #6610f2; color: white; }
    
    /* Cartes de statistiques */
    .stat-card {
        border-radius: 10px;
        transition: all 0.3s ease;
    }
    
    .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    
    .stat-card-icon {
        font-size: 2.5rem;
        opacity: 0.8;
    }
    
    .stat-card-value {
        font-size: 2rem;
        font-weight: bold;
        color: #10536E;
    }
    
    .stat-card-label {
        color: #6c757d;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 1px;
    }
    
    /* Boutons d'action */
    .action-buttons .btn {
        margin-right: 5px;
        margin-bottom: 5px;
    }
    
    /* Timeline des approbations */
    .timeline {
        position: relative;
        padding: 20px 0;
    }
    
    .timeline::before {
        content: '';
        position: absolute;
        left: 50%;
        top: 0;
        bottom: 0;
        width: 2px;
        background-color: #10536E;
        transform: translateX(-50%);
    }
    
    .timeline-item {
        position: relative;
        margin-bottom: 30px;
    }
    
    .timeline-content {
        background-color: white;
        border-radius: 8px;
        padding: 15px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        position: relative;
        width: 45%;
    }
    
    .timeline-item:nth-child(odd) .timeline-content {
        left: 0;
    }
    
    .timeline-item:nth-child(even) .timeline-content {
        left: 55%;
    }
    
    .timeline-dot {
        position: absolute;
        left: 50%;
        top: 20px;
        width: 20px;
        height: 20px;
        background-color: #10536E;
        border-radius: 50%;
        transform: translateX(-50%);
        z-index: 1;
    }
    
    /* Formulaires */
    .form-section {
        background-color: white;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .form-section-title {
        color: #10536E;
        border-bottom: 2px solid #10536E;
        padding-bottom: 10px;
        margin-bottom: 20px;
    }
    
    /* Tableaux */
    .table-hover tbody tr {
        transition: background-color 0.2s ease;
    }
    
    .table-hover tbody tr:hover {
        background-color: rgba(16, 83, 110, 0.05);
    }
    
    /* Badges colorés */
    .badge-pill {
        border-radius: 10rem;
    }
    
    /* Barre de progression */
    .progress {
        height: 10px;
        border-radius: 5px;
    }
    
    .progress-bar {
        background-color: #10536E;
    }
    
    /* Calendrier */
    .fc-toolbar {
        background-color: white;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 20px;
    }
    
    .fc-button-primary {
        background-color: #10536E !important;
        border-color: #10536E !important;
    }
    
    .fc-button-primary:hover {
        background-color: #0a3d52 !important;
        border-color: #0a3d52 !important;
    }
    
    .fc-button-active {
        background-color: #0a3d52 !important;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
        .timeline::before {
            left: 20px;
        }
        
        .timeline-content {
            width: calc(100% - 50px);
            left: 50px !important;
        }
        
        .timeline-dot {
            left: 20px;
        }
        
        .stat-card-value {
            font-size: 1.5rem;
        }
        
        .action-buttons .btn {
            width: 100%;
            margin-right: 0;
            margin-bottom: 10px;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <!-- Header avec titre et boutons d'action -->
            
            <!-- Contenu principal -->
            {% block leaves_content %}{% endblock %}
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<!-- FullCalendar JS avec plugins -->
<!-- FullCalendar JS complet -->
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js'></script>
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales/fr.js'></script>
<script src='https://cdn.jsdelivr.net/npm/@fullcalendar/daygrid@5.11.3/index.global.min.js'></script>
<script src='https://cdn.jsdelivr.net/npm/@fullcalendar/timegrid@5.11.3/index.global.min.js'></script>
<script src='https://cdn.jsdelivr.net/npm/@fullcalendar/list@5.11.3/index.global.min.js'></script>
<script src='https://cdn.jsdelivr.net/npm/@fullcalendar/interaction@5.11.3/index.global.min.js'></script>

<!-- Select2 JS -->
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/i18n/fr.js"></script>

<!-- Datatables JS -->
<script type="text/javascript" src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    // Initialiser Select2

// Attendre que jQuery soit chargé
(function($) {
    $(document).ready(function() {
        console.log('Base leaves JS chargé, jQuery disponible:', typeof $ !== 'undefined');
        console.log('FullCalendar disponible:', typeof FullCalendar !== 'undefined');
        
        // Initialiser Select2
        $('.select2').select2({
            language: 'fr',
            theme: 'bootstrap-5'
        });
        
        // Initialiser DataTables
        $('.datatable').DataTable({
            language: {
                url: '//cdn.datatables.net/plug-ins/1.13.4/i18n/fr-FR.json'
            },
            pageLength: 25,
            responsive: true
        });
        
        // Tooltips
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
        });
        
        // Confirmation avant suppression
        $('.confirm-delete').on('click', function() {
            return confirm('Êtes-vous sûr de vouloir supprimer cet élément ? Cette action est irréversible.');
        });
    });
})(jQuery);

    $(document).ready(function() {
        $('.select2').select2({
            language: 'fr',
            theme: 'bootstrap-5'
        });
        
        // Initialiser DataTables
     
        // Tooltips
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
        });
        
        // Confirmation avant suppression
        $('.confirm-delete').on('click', function() {
            return confirm('Êtes-vous sûr de vouloir supprimer cet élément ? Cette action est irréversible.');
        });
    });
    
    // Fonctions utilitaires
    function formatDate(dateStr) {
        if (!dateStr) return '';
        const date = new Date(dateStr);
        return date.toLocaleDateString('fr-FR', {
            day: '2-digit',
            month: '2-digit',
            year: 'numeric'
        });
    }
    
    function formatDateTime(dateStr) {
        if (!dateStr) return '';
        const date = new Date(dateStr);
        return date.toLocaleDateString('fr-FR', {
            day: '2-digit',
            month: '2-digit',
            year: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        });
    }
    
    // Calcul de jours restants
    function calculateDaysRemaining(endDateStr) {
        const endDate = new Date(endDateStr);
        const today = new Date();
        const diffTime = endDate - today;
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        return diffDays;
    }
</script>

{% block leaves_extra_js %}{% endblock %}
{% endblock %}